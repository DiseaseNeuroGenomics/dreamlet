<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Differential expression between pair of assays — dreamletCompareClusters • dreamlet</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Differential expression between pair of assays — dreamletCompareClusters"><meta property="og:description" content="Perform differential expression between a pair of assays using linear (mixed) models"><meta property="og:image" content="http://gabrielhoffman.github.io/dreamlet/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dreamlet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.31</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/dreamlet.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/h5ad_on_disk.html">Loading large-scale H5AD datasets</a>
    </li>
    <li>
      <a href="../articles/mashr.html">mashr analysis following dreamlet</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/GabrielHoffman/dreamlet/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Differential expression between pair of assays</h1>
    <small class="dont-index">Source: <a href="https://github.com/GabrielHoffman/dreamlet/blob/HEAD/R/dreamletCompareClusters.R" class="external-link"><code>R/dreamletCompareClusters.R</code></a></small>
    <div class="hidden name"><code>dreamletCompareClusters.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform differential expression between a pair of assays using linear (mixed) models</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">dreamletCompareClusters</span><span class="op">(</span>
  <span class="va">pb</span>,
  <span class="va">assays</span>,
  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fixed"</span>, <span class="st">"random"</span>, <span class="st">"none"</span><span class="op">)</span>,
  formula <span class="op">=</span> <span class="op">~</span><span class="fl">0</span>,
  collapse <span class="op">=</span> <span class="cn">TRUE</span>,
  min.cells <span class="op">=</span> <span class="fl">10</span>,
  min.count <span class="op">=</span> <span class="fl">10</span>,
  min.samples <span class="op">=</span> <span class="fl">4</span>,
  isCounts <span class="op">=</span> <span class="cn">TRUE</span>,
  normalize.method <span class="op">=</span> <span class="st">"TMM"</span>,
  useCountsWeights <span class="op">=</span> <span class="cn">TRUE</span>,
  robust <span class="op">=</span> <span class="cn">FALSE</span>,
  quiet <span class="op">=</span> <span class="cn">FALSE</span>,
  contrasts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"cellClustertest - cellClusterbaseline"</span><span class="op">)</span><span class="op">)</span>,
  BPPARAM <span class="op">=</span> <span class="fu">SerialParam</span><span class="op">(</span><span class="op">)</span>,
  errorsAsWarnings <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>pb</dt>
<dd><p>pseudobulk data as SingleCellExperiment object</p></dd>
<dt>assays</dt>
<dd><p>array of two entries specifying assays (i.e. cell clusters) to compare, of a list of two sets of assays.</p></dd>
<dt>method</dt>
<dd><p>account for repeated measures from donors using a "random" effect, a "fixed" effect, or "none"</p></dd>
<dt>formula</dt>
<dd><p>covariates to include in the analysis.</p></dd>
<dt>collapse</dt>
<dd><p>if TRUE (default), combine all cell clusters within the test set, and separately the baseline set. If FALSE, estimate coefficient for each cell cluster and then identify differential expression using linear contrasts with <code><a href="https://rdrr.io/pkg/variancePartition/man/makeContrastsDream.html" class="external-link">variancePartition::makeContrastsDream()</a></code></p></dd>
<dt>min.cells</dt>
<dd><p>minimum number of observed cells for a sample to be included in the analysis</p></dd>
<dt>min.count</dt>
<dd><p>minimum number of reads for a gene to be consider expressed in a sample.  Passed to <code><a href="https://rdrr.io/pkg/edgeR/man/filterByExpr.html" class="external-link">edgeR::filterByExpr</a></code></p></dd>
<dt>min.samples</dt>
<dd><p>minimum number of samples passing cutoffs for cell cluster to be retained</p></dd>
<dt>isCounts</dt>
<dd><p>logical, indicating if data is raw counts</p></dd>
<dt>normalize.method</dt>
<dd><p>normalization method to be used by <code>calcNormFactors</code></p></dd>
<dt>useCountsWeights</dt>
<dd><p>use cell count weights</p></dd>
<dt>robust</dt>
<dd><p>logical, use eBayes method that is robust to outlier genes</p></dd>
<dt>quiet</dt>
<dd><p>show messages</p></dd>
<dt>contrasts</dt>
<dd><p>cell type is encoded in variable <code>cellCluster</code> with levels <code>test</code> and <code>baseline</code>. <code>contrasts</code> specifies contrasts passed to <code><a href="https://rdrr.io/pkg/variancePartition/man/makeContrastsDream.html" class="external-link">variancePartition::makeContrastsDream()</a></code>.  Note, advanced users only.</p></dd>
<dt>BPPARAM</dt>
<dd><p>parameters for parallel evaluation</p></dd>
<dt>errorsAsWarnings</dt>
<dd><p>if <code>TRUE</code>, convert error to a warning and return <code>NULL</code></p></dd>
<dt>...</dt>
<dd><p>other arguments passed to <code>dream</code></p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Analyze pseudobulk data to identify differential gene expression between two cell clusters or sets of clusters while modeling the cross-donor expression variation and other aspects of the study design.</p>
<p><code>method</code> indicates the regression method used to test differential expression between sets of cell clusters.  Since the same biosample will usually be represented in both sets of cell clusters, <code>method</code> determines how the paired design is modeled.   For <code>method = "mixed"</code>, the sample is modeled as a random effect: <code>~ (1|Sample) + ...</code>. For <code>method = "fixed"</code>, the sample is modeled as a fixed effect: <code>~ Sample + ...</code>. For <code>method = "none"</code>, the pairing is ignored.</p>
<p>When <code>collapse=TRUE</code> (default) combine all cell clusters within the test set, and separately the baseline set, and estimate a coefficient indicating the differential expression between sets for a given gene.  If <code>collapse=FALSE</code>, estimate a coefficient for each cell type and then identify differential expression using linear contrasts with <code><a href="https://rdrr.io/pkg/variancePartition/man/makeContrastsDream.html" class="external-link">variancePartition::makeContrastsDream()</a></code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HelenaLC/muscat" class="external-link">muscat</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SingleCellExperiment</span><span class="op">)</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/muscat/man/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">example_sce</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># create pseudobulk for each sample and cell cluster</span></span>
<span class="r-in"><span class="va">pb</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregateToPseudoBulk.html">aggregateToPseudoBulk</a></span><span class="op">(</span><span class="va">example_sce</span>, </span>
<span class="r-in">  assay <span class="op">=</span> <span class="st">"counts"</span>,    </span>
<span class="r-in">  cluster_id <span class="op">=</span> <span class="st">'cluster_id'</span>, </span>
<span class="r-in">  sample_id <span class="op">=</span> <span class="st">'sample_id'</span>,</span>
<span class="r-in">  verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Evaluate the specificity of each gene for each cluster</span></span>
<span class="r-in"><span class="va">df_cts</span> <span class="op">=</span> <span class="fu"><a href="cellTypeSpecificity.html">cellTypeSpecificity</a></span><span class="op">(</span> <span class="va">pb</span> <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># compare first two assays (i.e. cell types)</span></span>
<span class="r-in"><span class="va">ct.pairs</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B cells"</span>, <span class="st">"CD14+ Monocytes"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># run comparison</span></span>
<span class="r-in"><span class="co"># use method = 'fixed' here since it is faster</span></span>
<span class="r-in"><span class="va">fit</span> <span class="op">=</span> <span class="fu">dreamletCompareClusters</span><span class="op">(</span> <span class="va">pb</span>, <span class="va">ct.pairs</span>, method<span class="op">=</span><span class="st">"fixed"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fixed effect model, using limma directly...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Initial filtering...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering for paired samples...</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Extract top 10 differentially expressed genes</span></span>
<span class="r-in"><span class="co"># The coefficient 'compare' is the value logFC between test and baseline:</span></span>
<span class="r-in"><span class="co"># compare = cellClustertest - cellClusterbaseline </span></span>
<span class="r-in"><span class="va">res</span> <span class="op">=</span> <span class="fu">topTable</span><span class="op">(</span><span class="va">fit</span>, coef<span class="op">=</span><span class="st">'compare'</span>, number<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># genes with highest logFC are most highly expressed in </span></span>
<span class="r-in"><span class="co"># B cells compared to CD14+ Monocytes</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             logFC   AveExpr         t      P.Value    adj.P.Val        B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LGALS3  -4.816806  9.879829 -23.63531 6.877513e-11 2.734301e-08 15.43980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FTL     -4.564199 14.265849 -23.14857 8.639180e-11 2.734301e-08 15.38182</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S100A10 -4.554573  9.950588 -20.89339 2.649274e-10 5.235895e-08 14.20355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S100A11 -4.691552 10.362616 -20.47182 3.308623e-10 5.235895e-08 14.00639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CD63    -3.888883 10.337664 -19.45422 5.762971e-10 7.295921e-08 13.49395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ANXA5   -3.673970 10.097965 -18.67233 8.996651e-10 9.491467e-08 13.05493</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">dreamlet</span><span class="fu">::</span><span class="fu"><a href="plotHeatmap-methods.html">plotHeatmap</a></span><span class="op">(</span> <span class="va">df_cts</span>, genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-plt img"><img src="dreamletCompareClusters-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># compare B cells versus the rest of the cell types</span></span>
<span class="r-in"><span class="co"># 'rest' is a keyword indicating all other assays  </span></span>
<span class="r-in"><span class="va">fit</span> <span class="op">=</span> <span class="fu">dreamletCompareClusters</span><span class="op">(</span> <span class="va">pb</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B cells"</span>, <span class="st">'rest'</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"fixed"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fixed effect model, using limma directly...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Initial filtering...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering for paired samples...</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">res</span> <span class="op">=</span> <span class="fu">topTable</span><span class="op">(</span><span class="va">fit</span>, coef<span class="op">=</span><span class="st">'compare'</span>, number<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># genes with highest logFC are most highly expressed in </span></span>
<span class="r-in"><span class="co"># B cells compared to all others</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             logFC   AveExpr         t      P.Value    adj.P.Val        B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FTL     -3.611668 13.872811 -33.50421 9.981991e-16 8.873990e-13 26.46896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FTH1    -2.488733 15.497594 -26.99381 2.576095e-14 1.145074e-11 23.03711</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ANXA1   -5.767273  8.777334 -26.00994 4.492584e-14 1.331302e-11 22.22040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S100A11 -4.235512 10.182616 -21.67526 6.800058e-13 1.511313e-10 19.91233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LGALS3  -3.908627  9.492690 -20.76951 1.279724e-12 2.275350e-10 19.24959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S100A10 -3.759699  9.613494 -19.60603 2.997582e-12 4.441418e-10 18.44009</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Get genes upregulated in B cells</span></span>
<span class="r-in"><span class="va">idx</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">res</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span class="r-in"><span class="fu">dreamlet</span><span class="fu">::</span><span class="fu"><a href="plotHeatmap-methods.html">plotHeatmap</a></span><span class="op">(</span> <span class="va">df_cts</span>, genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-plt img"><img src="dreamletCompareClusters-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">lst</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD14+ Monocytes"</span>, <span class="st">"FCGR3A+ Monocytes"</span><span class="op">)</span>, </span>
<span class="r-in">    baseline<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD4 T cells"</span>, <span class="st">"CD8 T cells"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># compare 2 monocyte clusters to two T cell clusters</span></span>
<span class="r-in"><span class="va">fit</span> <span class="op">=</span> <span class="fu">dreamletCompareClusters</span><span class="op">(</span> <span class="va">pb</span>, <span class="va">lst</span>, method<span class="op">=</span><span class="st">"fixed"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fixed effect model, using limma directly...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Initial filtering...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering for paired samples...</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">res</span> <span class="op">=</span> <span class="fu">topTable</span><span class="op">(</span><span class="va">fit</span>, coef<span class="op">=</span><span class="st">'compare'</span>, number<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># genes with highest logFC are most highly expressed in </span></span>
<span class="r-in"><span class="co"># monocytes compared to T cells</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            logFC   AveExpr        t      P.Value    adj.P.Val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FTL                     5.198559 13.603905 50.01440 1.092326e-12 9.470466e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TIMP1                   6.210031 11.076844 40.65163 7.542168e-12 3.269530e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HLA-DRA_ENSG00000204287 5.675747  9.655697 30.70867 1.023387e-10 2.957589e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S100A4                  4.514048  9.249845 26.98984 3.384453e-10 6.042015e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSAP                    3.947873  9.342828 26.51227 3.992245e-10 6.042015e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SOD2                    5.688725  9.919582 26.37995 4.181325e-10 6.042015e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FTL                     19.78358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TIMP1                   17.76489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HLA-DRA_ENSG00000204287 15.13660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S100A4                  14.12368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSAP                    13.98677</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SOD2                    13.92513</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Get genes upregulated in monocytes</span></span>
<span class="r-in"><span class="va">idx</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">res</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">logFC</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span class="r-in"><span class="fu">dreamlet</span><span class="fu">::</span><span class="fu"><a href="plotHeatmap-methods.html">plotHeatmap</a></span><span class="op">(</span> <span class="va">df_cts</span>, genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-plt img"><img src="dreamletCompareClusters-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="http://gabrielhoffman.github.io" class="external-link">Gabriel Hoffman</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'dedcc260e9d3743bc634e728855cdbaf',
    indexName: 'dreamlet',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

